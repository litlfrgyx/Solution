# Application Configuration

# Camera Settings
camera:
  # Active camera source (will be used by default)
  source: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1762982444/ei/zKUUaa2SJcyL6dsP3vvgkQ0/ip/78.99.33.114/id/p0Qhe4vhYLQ.4/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/rqh/1/hls_chunk_host/rr3---sn-nav853-3njl.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/playlist_duration/30/manifest_duration/30/bui/AdEuB5RjXcBHak-1xOjpGQZFzLAXmzFGgqDHDngkiWvkqe_qiDCu6zqh3Mi9h6fV9KXqoeq7FI3nR59Y/spc/6b0G_LZmacmOHwkNmASv/vprv/1/playlist_type/DVR/cps/0/initcwndbps/2617500/met/1762960844,/mh/xj/mm/44/mn/sn-nav853-3njl/ms/lva/mv/m/mvi/3/pl/24/rms/lva,lva/dover/11/pacing/0/keepalive/yes/fexp/51552689,51565115,51565681,51580968/mt/1762960354/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,rqh,xpc,playlist_duration,manifest_duration,bui,spc,vprv,playlist_type/sig/AJfQdSswRAIgUDmc5cfUHgfVIHY6-NIaDctLMIeu_pwiO1hyoN4PihgCIHkyjn3yl7uaDVQRZd2n_jcU4IjL2RoIxj8H0mKpWhYt/lsparams/hls_chunk_host,cps,initcwndbps,met,mh,mm,mn,ms,mv,mvi,pl,rms/lsig/APaTxxMwRQIgZb4Qor5aP6RuR3rPYBGDp0UnDVX5bouxb_q-SgWIqpICIQDS6Rkv2jUGkmqUrDV9cMm391fazmjvFH_G1SGAb5ZSrQ%3D%3D/playlist/index.m3u8"
  
  # Multiple camera sources - switch between them via API
  # Use POST /camera/switch with {"camera_id": "camera1"} to switch
  # Run: python get_youtube_stream.py "YOUR_YOUTUBE_URL" to get stream URL
  sources:
    camera1:
      name: "YouTube Stream 1"
      url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1762982444/ei/zKUUaa2SJcyL6dsP3vvgkQ0/ip/78.99.33.114/id/p0Qhe4vhYLQ.4/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/rqh/1/hls_chunk_host/rr3---sn-nav853-3njl.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/playlist_duration/30/manifest_duration/30/bui/AdEuB5RjXcBHak-1xOjpGQZFzLAXmzFGgqDHDngkiWvkqe_qiDCu6zqh3Mi9h6fV9KXqoeq7FI3nR59Y/spc/6b0G_LZmacmOHwkNmASv/vprv/1/playlist_type/DVR/cps/0/initcwndbps/2617500/met/1762960844,/mh/xj/mm/44/mn/sn-nav853-3njl/ms/lva/mv/m/mvi/3/pl/24/rms/lva,lva/dover/11/pacing/0/keepalive/yes/fexp/51552689,51565115,51565681,51580968/mt/1762960354/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,rqh,xpc,playlist_duration,manifest_duration,bui,spc,vprv,playlist_type/sig/AJfQdSswRAIgUDmc5cfUHgfVIHY6-NIaDctLMIeu_pwiO1hyoN4PihgCIHkyjn3yl7uaDVQRZd2n_jcU4IjL2RoIxj8H0mKpWhYt/lsparams/hls_chunk_host,cps,initcwndbps,met,mh,mm,mn,ms,mv,mvi,pl,rms/lsig/APaTxxMwRQIgZb4Qor5aP6RuR3rPYBGDp0UnDVX5bouxb_q-SgWIqpICIQDS6Rkv2jUGkmqUrDV9cMm391fazmjvFH_G1SGAb5ZSrQ%3D%3D/playlist/index.m3u8"
    camera2:
      name: "YouTube Stream 2"
      url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1762983734/ei/1qoUadWCFLy46dsP06Km4Qo/ip/78.99.33.114/id/UZgmBGbmDZ4.1/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/rqh/1/hls_chunk_host/rr2---sn-nav853-3njl.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/playlist_duration/30/manifest_duration/30/bui/AdEuB5QeCL3oqhHiDs0JY0vA1OzoyIY-MLR7NFjm-VacixaVOhWjNlMgKxNod2YaYkfOqO5NWqWDxbrJ/spc/6b0G_HgUqtEoYoVJo7X_/vprv/1/playlist_type/DVR/cps/0/initcwndbps/2680000/met/1762962134,/mh/H4/mm/44/mn/sn-nav853-3njl/ms/lva/mv/m/mvi/2/pl/24/rms/lva,lva/dover/11/pacing/0/keepalive/yes/fexp/51552689,51565116,51565681,51580968/mt/1762961799/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,rqh,xpc,playlist_duration,manifest_duration,bui,spc,vprv,playlist_type/sig/AJfQdSswRQIgQY6Ygim3lkCyaNg9FIJyzQoIALlAtN8Gebp4_e94QKsCIQCKM1ebYvydNDwIEy-g3QSutkq5edeBxi10q0w7qcHLJQ%3D%3D/lsparams/hls_chunk_host,cps,initcwndbps,met,mh,mm,mn,ms,mv,mvi,pl,rms/lsig/APaTxxMwRQIhAMeLbecATJL8ziUiypwlsxx9daoleN05WgCHgAbGYwuGAiBvsBA9nJLR2r-7IJsHoSKGHOh28i1vy6vKmk54wNfz-w%3D%3D/playlist/index.m3u8"
    camera3:
      name: "YouTube Stream 3"
      url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1762983816/ei/KKsUaY_RJ8SD6dsP4oqj0Aw/ip/78.99.33.114/id/eIdw-1M4hqU.1/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/rqh/1/hls_chunk_host/rr1---sn-nav853-3njl.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/playlist_duration/30/manifest_duration/30/bui/AdEuB5Qj0yPhSzV5xsX2xG6NxnEhKVoCIBwuhPfk2RWE8rdxhwuUyKJWpKbhA-tbLpF2trTpS8NQskv0/spc/6b0G_J06PfNz1Y3sbKGn/vprv/1/playlist_type/DVR/cps/0/initcwndbps/2680000/met/1762962217,/mh/xK/mm/44/mn/sn-nav853-3njl/ms/lva/mv/m/mvi/1/pl/24/rms/lva,lva/dover/11/pacing/0/keepalive/yes/fexp/51552689,51565115,51565682,51580968/mt/1762961799/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,rqh,xpc,playlist_duration,manifest_duration,bui,spc,vprv,playlist_type/sig/AJfQdSswRQIhAPiYTmZYo4ndLBp4UXVrYvz3Yc8aa8_RzWbK_p2dja5LAiBSCeDFn4xQPIrqdlu14I5ODnYFzmQPGGmiQowNvNpLyQ%3D%3D/lsparams/hls_chunk_host,cps,initcwndbps,met,mh,mm,mn,ms,mv,mvi,pl,rms/lsig/APaTxxMwRAIgc0QDEkt_R6uzBXVK_gFnaY0lCj5lD0Z_Xi-uXuvTBcUCIALoXSu2SJ-4CKV56UnF7pVBbjwFfOYB-4MOyI-Srb16/playlist/index.m3u8"
  
  fps: 30
  resolution:
    width: 640
    height: 480

# Object Detection Settings
detection:
  # YOLOv8 model variant: yolov8n, yolov8s, yolov8m, yolov8l, yolov8x
  model: "yolov8n"  # Nano - fastest, good for real-time
  
  # Confidence threshold (0-1)
  confidence: 0.5
  
  # Detection interval (process every N frames to save resources)
  frame_interval: 1
  
  # Classes to detect (COCO dataset class names)
  target_classes:
    - "person"
  
  # Classes to ignore
  ignore_classes:
    - "bird"
    - "cat"
    - "dog"
  
  # Size filtering (bounding box area in pixels)
  # LOWERED for smoother transitions - smaller/distant objects still detected
  min_object_size: 1000   # Minimum area to trigger lights (lowered from 5000)
  max_object_size: 300000  # Maximum area (ignore if too large)

# Light Control Settings
lighting:
  # Control mode: "simulated", "mqtt", "http", "hue"
  mode: "simulated"
  
  # Light intensity levels (0-100)
  brightness:
    off: 0
    low: 30
    medium: 60
    high: 100
  
  # Default brightness when person detected (DEPRECATED - now calculated dynamically)
  default_on_brightness: 80
  
  # Dynamic brightness calculation
  # Brightness is calculated based on detection score:
  # score = sum(confidence_i × relative_area_i × class_weight_i) for all detections
  # Then mapped to brightness range (min_brightness to max_brightness)
  dynamic_brightness:
    enabled: true
    min_brightness: 10      # Minimum brightness when any object detected (lowered for smoother range)
    max_brightness: 100     # Maximum brightness
    score_threshold: 0.001  # Very low threshold - detect even distant/small objects
    score_ceiling: 0.15     # Lower ceiling for more gradual brightness changes
    
    # Class weights for score calculation
    # Higher weight = more impact on brightness
    class_weights:
      person: 1.0           # Highest priority
      car: 0.5
      truck: 0.5
      bicycle: 0.4
      motorcycle: 0.4
      cat: 0.3
      dog: 0.3
      bird: 0.2
      default: 0.1          # Weight for unlisted classes
  
  # Transition settings
  fade_duration: 0.5  # seconds - faster transitions
  debounce_time: 0.1  # seconds - very low debounce for real-time updates
  auto_off_delay: 5.0  # seconds - turn off after no detection (reduced)
  
  # MQTT Settings (if mode is "mqtt")
  mqtt:
    broker: "localhost"
    port: 1883
    topic: "home/lights/control"
    username: null
    password: null
  
  # HTTP Settings (if mode is "http")
  http:
    url: "http://localhost:8000/api/lights"
    method: "POST"
  
  # Philips Hue Settings (if mode is "hue")
  hue:
    bridge_ip: "192.168.1.100"
    username: "your-hue-username"
    light_ids: [1, 2, 3]

# API Settings
api:
  host: "0.0.0.0"
  port: 8000
  reload: true
  log_level: "info"

# Logging
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  save_detections: true
  detection_log_file: "detections.log"
