services:
  object-detection:
    # Build locally (uncomment for development)
    build:
      context: .
      dockerfile: Dockerfile
    # Use pre-built image (for team members)
    # image: rs735my/smart-lighting-detection:latest
    container_name: smart-lighting-detection
    ports:
      - "8000:8000"
    volumes:
      # Mount config for easy editing without rebuilding
      - ./config.yaml:/app/config.yaml
      # Optional: Mount video files if using local video sources
      - ./videos:/app/videos
      # Cache for YOLOv8 models to avoid re-downloading
      - yolo-models:/root/.cache/torch/hub/checkpoints
    # devices:
      # Grant access to webcam (Linux/Mac)
      # On Windows with WSL2, webcam access is limited
      # NOTE: Webcam access disabled - use IP camera or video file instead
      # - /dev/video0:/dev/video0
    environment:
      - TZ=Europe/Prague
    restart: unless-stopped
    # Use host network for better camera access (optional, Linux only)
    # network_mode: "host"

volumes:
  yolo-models:
    driver: local
